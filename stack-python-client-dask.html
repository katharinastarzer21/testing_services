<!DOCTYPE html><html lang="en" class="" style="scroll-padding:60px"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>STACK service - Python Client Dask - DEDL notebook gallery</title><meta property="og:title" content="STACK service - Python Client Dask - DEDL notebook gallery"/><meta name="generator" content="mystmd"/><meta name="keywords" content=""/><meta name="image" content="/build/b27bd30f978ddf0848f3ea0942070886.jpeg"/><meta property="og:image" content="/build/b27bd30f978ddf0848f3ea0942070886.jpeg"/><link rel="stylesheet" href="/build/_assets/app-SP33RAUV.css"/><link rel="stylesheet" href="/build/_assets/thebe-core-VKVHG5VY.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/><link rel="icon" href="/favicon.ico"/><link rel="stylesheet" href="/myst-theme.css"/><script>
  const savedTheme = localStorage.getItem("myst:theme");
  const theme = window.matchMedia("(prefers-color-scheme: light)").matches ? 'light' : 'dark';
  const classes = document.documentElement.classList;
  const hasAnyTheme = classes.contains('light') || classes.contains('dark');
  if (!hasAnyTheme) classes.add(savedTheme ?? theme);
</script></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-frontmatter" class="block px-2 py-1 text-black underline">Skip to article frontmatter</a><a href="#skip-to-article" class="block px-2 py-1 text-black underline">Skip to article content</a></div><div class="bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 sticky w-screen top-0 z-30 h-[60px]"><nav class="flex items-center justify-between flex-nowrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center shrink-0"><div class="block xl:hidden"><button class="flex items-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="m-1"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 0 1 3.75 6h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 6.75ZM3 12a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 12Zm0 5.25a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="/"><div class="p-1 mr-3 dark:bg-white dark:rounded"><img src="/build/logo_bar-3bd55b7490dd93158f43624888cf0e4a.png" class="h-9" height="2.25rem"/></div><span class="text-md sm:text-xl tracking-tight sm:mr-5 sr-only">Made with MyST</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"></div><div class="flex-grow block"></div><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R74op:" data-state="closed" class="flex items-center h-10 aspect-square sm:w-64 text-left text-gray-400 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 hover:ring-blue-500 dark:hover:ring-blue-500 hover:border-blue-500 dark:hover:border-blue-500"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="p-2.5 h-10 w-10 aspect-square"><path fill-rule="evenodd" d="M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z" clip-rule="evenodd"></path></svg><span class="hidden sm:block grow">Search</span><div aria-hidden="true" class="items-center hidden mx-1 font-mono text-sm text-gray-400 sm:flex gap-x-1"><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none hide-mac">CTRL</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none show-mac">⌘</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none ">K</kbd><script>
;(() => {
const script = document.currentScript;
const root = script.parentElement;

const isMac = /mac/i.test(
      window.navigator.userAgentData?.platform ?? window.navigator.userAgent,
    );
root.querySelectorAll(".hide-mac").forEach(node => {node.classList.add(isMac ? "hidden" : "block")});
root.querySelectorAll(".show-mac").forEach(node => {node.classList.add(!isMac ? "hidden" : "block")});
})()</script></div></button><button class="theme rounded-full aspect-square border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-8 h-8 mx-3" title="Toggle theme between light and dark mode." aria-label="Toggle theme between light and dark mode."><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 hidden dark:block"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 0 1 .162.819A8.97 8.97 0 0 0 9 6a9 9 0 0 0 9 9 8.97 8.97 0 0 0 3.463-.69.75.75 0 0 1 .981.98 10.503 10.503 0 0 1-9.694 6.46c-5.799 0-10.5-4.7-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 0 1 .818.162Z" clip-rule="evenodd"></path></svg><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 dark:hidden"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"></path></svg></button><div class="block sm:hidden"></div><div class="hidden sm:block"></div></div></nav></div><div class="fixed xl:article-grid grid-gap xl:w-screen xl:pointer-events-none overflow-auto max-xl:min-w-[300px] hidden z-10" style="top:60px"><div class="pointer-events-auto xl:col-margin-left flex-col overflow-hidden hidden xl:flex"><div class="flex-grow py-6 overflow-y-auto primary-scrollbar"><nav aria-label="Navigation" class="overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px] lg:hidden"><div class="w-full px-1 dark:text-white"></div></nav><div class="my-3 border-b-2 lg:hidden"></div><nav aria-label="Table of Contents" class="flex-grow overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px]"><div class="w-full px-1 dark:text-white"><a title="DEDL notebook gallery" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30 font-bold" href="/">DEDL notebook gallery</a><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="HDA" class="block break-words rounded py-2 grow cursor-pointer">HDA</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rmp8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rmp8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="HOOK" class="block break-words rounded py-2 grow cursor-pointer">HOOK</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rup8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rup8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="open" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="STACK" class="block break-words rounded py-2 grow font-semibold text-blue-800 dark:text-blue-200 cursor-pointer">STACK</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R16p8p:" aria-expanded="true" data-state="open"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="open" id="radix-:R16p8p:" class="pl-3 pr-[2px] collapsible-content"><a title="STACK Service" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/readme-2">STACK Service</a><div data-state="open" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="STACK Gallery" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow font-semibold text-blue-800 dark:text-blue-200" href="/gallery-2">STACK Gallery</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R1b6p8p:" aria-expanded="true" data-state="open"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="open" id="radix-:R1b6p8p:" class="pl-3 pr-[2px] collapsible-content"><a title="STACK service - Python Client Dask" aria-current="page" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg bg-blue-300/30 active" href="/stack-python-client-dask">STACK service - Python Client Dask</a><a title="STACK service - Dask 101" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/stack-dask-101">STACK service - Dask 101</a><a title="Data Cube populated with data obtained from Weather and Geophysical Extremes Digital Twin (DT) - ExtremeDT" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/extremedt-datacube">Data Cube populated with data obtained from Weather and Geophysical Extremes Digital Twin (DT) - ExtremeDT</a><a title="Create a dashboard based on Data Cube populated with data obtained from Weather and Geophysical Extremes Digital Twin (DT) - ExtremeDT" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/extremedt-datacube-xviewer">Create a dashboard based on Data Cube populated with data obtained from Weather and Geophysical Extremes Digital Twin (DT) - ExtremeDT</a><a title="DestinE Data Lake - Stack Service Dask" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/dedl-stackservice-dask">DestinE Data Lake - Stack Service Dask</a></div></div></div></div><div title="Cookbook Gallery" class="block break-words rounded p-2 my-1 rounded-lg hover:bg-slate-300/30">Cookbook Gallery</div></div></nav></div><div class="flex-none py-6 transition-all duration-700 translate-y-6 opacity-0"><a class="flex mx-auto text-gray-700 w-fit hover:text-blue-700 dark:text-gray-200 dark:hover:text-blue-400" href="https://mystmd.org/made-with-myst" target="_blank" rel="noreferrer"><svg style="width:24px;height:24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" stroke="none"><g id="icon"><path fill="currentColor" d="M23.8,54.8v-3.6l4.7-0.8V17.5l-4.7-0.8V13H36l13.4,31.7h0.2l13-31.7h12.6v3.6l-4.7,0.8v32.9l4.7,0.8v3.6h-15
          v-3.6l4.9-0.8V20.8H65L51.4,53.3h-3.8l-14-32.5h-0.1l0.2,17.4v12.1l5,0.8v3.6H23.8z"></path><path fill="#F37726" d="M47,86.9c0-5.9-3.4-8.8-10.1-8.8h-8.4c-5.2,0-9.4-1.3-12.5-3.8c-3.1-2.5-5.4-6.2-6.8-11l4.8-1.6
          c1.8,5.6,6.4,8.6,13.8,8.8h9.2c6.4,0,10.8,2.5,13.1,7.5c2.3-5,6.7-7.5,13.1-7.5h8.4c7.8,0,12.7-2.9,14.6-8.7l4.8,1.6
          c-1.4,4.9-3.6,8.6-6.8,11.1c-3.1,2.5-7.3,3.7-12.4,3.8H63c-6.7,0-10,2.9-10,8.8"></path></g></svg><span class="self-center ml-2 text-sm">Made with MyST</span></a></div></div></div><article class="article content article-grid grid-gap"><main class="article-grid subgrid-gap col-screen"><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="mb-8 pt-9"><div class="flex items-center h-6 mb-5 text-sm font-light"><div class="flex-grow"></div><div class="inline-block mr-1"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block"><title>Jupyter Notebook</title><path d="M20.2 1.7c0 .8-.5 1.4-1.3 1.5-.8 0-1.4-.5-1.5-1.3 0-.8.5-1.4 1.3-1.5.8-.1 1.5.5 1.5 1.3zM12 17.9c-3.7 0-7-1.3-8.7-3.3 1.8 4.8 7.1 7.3 11.9 5.5 2.5-.9 4.5-2.9 5.5-5.5-1.7 2-4.9 3.3-8.7 3.3zM12 5.1c3.7 0 7 1.3 8.7 3.3-1.8-4.8-7.1-7.3-11.9-5.5-2.5.9-4.5 2.9-5.5 5.5 1.7-2 5-3.3 8.7-3.3zM6.9 21.8c.1 1-.7 1.8-1.7 1.9-1 .1-1.8-.7-1.9-1.7 0-1 .7-1.8 1.7-1.9 1-.1 1.8.7 1.9 1.7zM3.7 4.6c-.6 0-1-.4-1-1s.4-1 1-1 1 .4 1 1c0 .5-.4 1-1 1z"></path></svg></div><div class="relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="relative ml-2 -mr-1" id="headlessui-menu-button-:Rs8top:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem"><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div></div><h1 class="mb-0">STACK service - Python Client Dask</h1></div><div class="block my-10 lg:sticky lg:z-10 lg:h-0 lg:pt-0 lg:my-0 lg:ml-10 lg:col-margin-right" style="top:60px"><nav></nav></div><div id="skip-to-article"></div><div id="X9Hz2zT7bp" class="relative group/block"><img id="O5ujZH6IgS" style="margin:0 auto" src="/build/b27bd30f978ddf0848f3ea0942070886.jpeg" data-canonical-url="https://github.com/destination-earth/DestinE-DataLake-Lab/blob/main/img/DestinE-banner.jpg?raw=true"/></div><div id="yqMCgxIsc9" class="relative group/block"><p><strong>Licence</strong>: MIT <br/></p><img id="eRKCJMLaQb" style="margin:0 auto" src="/build/2b00998ddd74a039529882b6d26ca076.svg" alt="Dask logo" data-canonical-url="https://docs.dask.org/en/latest/_images/dask_horizontal.svg"/><h1 id="stack-service-python-client-dask" class="relative group"><span class="heading-text">STACK service - Python Client Dask</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#stack-service-python-client-dask" title="Link to this Section" aria-label="Link to this Section">¶</a></h1><h1 id="multi-cloud-processing-with-dask" class="relative group"><span class="heading-text">Multi-cloud processing with Dask</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#multi-cloud-processing-with-dask" title="Link to this Section" aria-label="Link to this Section">¶</a></h1><div class="alert-info"><h3 id="overview" class="relative group"><span class="heading-text">Overview</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#overview" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><h4 id="content" class="relative group"><span class="heading-text">Content</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#content" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><li><p>DestinE Data Lake (DEDL) Stack Client</p></li><li><p>Making use of clients context manager</p></li><li><p>Use Case: Pakistan Flood 2022</p></li><h4 id="duration-15-min" class="relative group"><span class="heading-text">Duration: 15 min.</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#duration-15-min" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><br/><div class="alert-warning">Please make sure Python DEDL kernel is used.</div><p>DestinE Data Lake utilises a deployment of <a target="_blank" rel="noreferrer" href="https://gateway.dask.org/" class="">Dask Gateway</a> on each location (bridge) in the data lake. Dask Gateway provides a secure, multi-tenant server for managing Dask clusters. It allows users to launch and use Dask clusters in a shared, centrally managed cluster environment, without requiring users to have direct access to the underlying cluster backend (e.g. Kubernetes, Hadoop/YARN, HPC Job queues, etc…).</p><p>Dask Gateway exposes a REST API to spawn clusters on demand. The overall architecture of Dask Gateway is depicted hereafter.</p><img id="dzhLh16tUL" style="margin:0 auto" src="/build/01f61b2ebec9f77ff63c7f40d6a20edc.png" data-canonical-url="https://github.com/destination-earth/DestinE-DataLake-Lab/blob/main/STACK/img/DEDL_Dask_multicloud.png?raw=true"/><h2 id="dedl-dask-gateway" class="relative group"><span class="heading-text">DEDL Dask Gateway</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#dedl-dask-gateway" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p><strong>Central Site</strong></p><ul><li>address: <a target="_blank" rel="noreferrer" href="http://dask.central.data.destination-earth.eu" class="">http://<wbr/>dask<wbr/>.central<wbr/>.data<wbr/>.destination<wbr/>-earth<wbr/>.eu</a></li><li>proxy_address: tcp://dask.central.data.destination-earth.eu:80</li></ul><p><strong>LUMI Bridge</strong></p><ul><li>address: <a target="_blank" rel="noreferrer" href="http://dask.lumi.data.destination-earth.eu" class="">http://<wbr/>dask<wbr/>.lumi<wbr/>.data<wbr/>.destination<wbr/>-earth<wbr/>.eu</a></li><li>proxy_address: tcp://dask.lumi.data.destination-earth.eu:80</li></ul><p>Only authenticated access is granted to the DEDL STACK service Dask, therefore a helper class to authenticate a user against the DESP identity management system is implemented. The users password is directly handed over to the request object and is not permanently stored.</p><p>In the following, please enter your DESP username and password. Again, the password will only be saved for the duration of this user session and will be remove as soon as the notebook/kernel is closed.</p></div><div id="rftSVRKHn7" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">from dask_gateway.auth import GatewayAuth
from getpass import getpass
from destinelab import AuthHandler as DESP_AuthHandler

class DESPAuth(GatewayAuth):
    def __init__(self, username: str):
        self.auth_handler = DESP_AuthHandler(username, getpass(&quot;Please input your DESP password: &quot;))
        self.access_token = self.auth_handler.get_token()
    
    def pre_request(self, _):
        headers = {&quot;Authorization&quot;: &quot;Bearer &quot; + self.access_token}
        return headers, None</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="ZniJ2TSoJiLqfgEnIq6Eq" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="wu5JyivJEr" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">from rich.prompt import Prompt
myAuth = DESPAuth(username=Prompt.ask(prompt=&quot;Username&quot;))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="suG2ObOjQ_Wf9_YLjabvP" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="jFOT60arzL" class="relative group/block"><h2 id="destine-data-lake-dedl-stack-client" class="relative group"><span class="heading-text">DestinE Data Lake (DEDL) Stack Client</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#destine-data-lake-dedl-stack-client" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>The <a target="_blank" rel="noreferrer" href="https://github.com/destination-earth/DestinE_EUMETSAT_DEDL_Stack_Client" class="">DEDL Stack Client is a Python</a> library to facilitate the use of Stack Service Dask. The main objective is to provide an abstraction layer to interact with the various clusters on each DEDL bridge. Computations can be directed to the different Dask clusters by making use of a context manager as given in the following.</p></div><div id="L0O8FiPx79" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">from dedl_stack_client.dask import DaskMultiCluster

myDEDLClusters = DaskMultiCluster(auth=myAuth)
myDEDLClusters.new_cluster()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="miC0hhlfqq564od_uSM3q" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Create new cluster for Central Site
Create new cluster for LUMI Bridge
</span></code></pre></div></div></div><div id="Y3xX5Og0s2" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">myDEDLClusters.get_cluster_url()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="NAKryh4TPJLmr_i6Z9uoo" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>http://dask.central.data.destination-earth.eu/clusters/dask-gateway.203d0155443945c986a35b0488db7ebb/status
http://dask.lumi.data.destination-earth.eu/clusters/dask-gateway.9010455c0c8a44df9a52e15003252889/status
</span></code></pre></div></div></div><div id="f4ARnUzT4k" class="relative group/block"><p>We can again showcase the execution of standard Python functions on the remote clusters.
In the following we will make use of <code>dask.futures</code>, non-blocking distributed calculations, utilising the <code>map()</code> method for task distribution. Detailed information about <code>dask.futures</code> can be found on the <a target="_blank" rel="noreferrer" href="https://docs.dask.org/en/stable/futures.html" class="">Dask documention</a>.</p><p>This approach allows for embarrassingly parallel task scheduling, which is very similar to Function as a Service capabilities.</p><img id="IL3e7ISz7N" style="margin:0 auto" src="/build/a3e154464638fb32cf560b6de9c384d8.svg" data-canonical-url="https://docs.dask.org/en/latest/_images/map-reduce-task-scheduling.svg"/></div><div id="RpXj4mXsBv" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">from time import sleep as wait

def apply_myfunc(x):
    wait(1)
    return x+1</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="YimdDUmYnrcEjyv9sPRGM" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="SBnGTOFrgv" class="relative group/block"><p>We want to run <code>apply_myfunc()</code> on <strong>Central Site</strong> and wait for all results to be ready. <code>my_filelist_central</code> represents a filelist to be processed by <code>apply_myfunc()</code>.</p></div><div id="eTIAFmO9ax" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">my_filelist_central = range(20)
with myDEDLClusters.as_current(location=&quot;central&quot;) as myclient:
    central_future = myclient.map(apply_myfunc, my_filelist_central)
    results_central = myclient.gather(central_future)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Gw9G38OPXt-X5A2ziCnAz" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="T9W1b0t6gA" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">results_central</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="JF2_pWnlr3L6pKOgfq3YR" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]</span></code></div></div></div><div id="hyTKkPGiQy" class="relative group/block"><p>Run computation at <strong>LUMI bridge</strong>.</p></div><div id="Bu3GsG2VWy" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">my_filelist_lumi = range(32)
with myDEDLClusters.as_current(location=&quot;lumi&quot;) as myclient:
    lumi_future = myclient.map(apply_myfunc, my_filelist_lumi)
    results_lumi = myclient.gather(lumi_future)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="nWG8IX4eCWfKsy2hMNavi" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="fGXzm7sZ94" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">results_lumi</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="3VyqZmH27R2z-F0o7C_lB" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>[1,
 2,
 3,
 4,
 5,
 6,
 7,
 8,
 9,
 10,
 11,
 12,
 13,
 14,
 15,
 16,
 17,
 18,
 19,
 20,
 21,
 22,
 23,
 24,
 25,
 26,
 27,
 28,
 29,
 30,
 31,
 32]</span></code></div></div></div><div id="LqJWIVAA57" class="relative group/block"><h2 id="limitations" class="relative group"><span class="heading-text">Limitations</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#limitations" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><ul><li>Python libraries use in the local environment need to match, same version, with those available in the Dask Cluster. If this is not the case, you will get a warning, code might work but not guaranteed.</li><li>No direct data exchange between Dask Workers across cloud locations possible. Each location acts as atmoic unit, however data can be easily exchanged via storage services such as S3.</li></ul></div><div id="AyCOrZSKHL" class="relative group/block"><h2 id="use-case-example-pakistan-flood-2022" class="relative group"><span class="heading-text">Use Case example: Pakistan Flood 2022</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#use-case-example-pakistan-flood-2022" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p><strong>The complete use case is available on GitHub via <a target="_blank" rel="noreferrer" href="https://github.com/destination-earth/DestinE_EUMETSAT_PakistanFlood_2022" class="">https://<wbr/>github<wbr/>.com<wbr/>/destination<wbr/>-earth<wbr/>/DestinE<wbr/>_EUMETSAT<wbr/>_PakistanFlood<wbr/>_2022</a>.</strong></p><p>The use case demonstrates the multi-cloud capabilities of DEDL following the paradigm of data proximate computing. Data of the <strong>Global Flood Monitoring (GFM)</strong> service as well as <strong>Climate DT outputs, simulated by utilising ERA5 data</strong> have been use for flood risk assessment.</p><img id="Pjjq8OThIJ" style="margin:0 auto" src="/build/fbe7b3a93dbabd237a3b9af41be26621.png" data-canonical-url="https://github.com/destination-earth/DestinE_EUMETSAT_PakistanFlood_2022/blob/main/img/DEDL_FloodUC_dataflow.png?raw=true"/></div><div id="IStM7f0RHH" class="relative group/block"><p>Data is stored as datacubes (zarr format) at Central Site and at LUMI bridge in object storage.</p></div><div id="aYIgWWNsml" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import s3fs
import xarray as xr

xr.set_options(keep_attrs=True)

s3fs_central = s3fs.S3FileSystem(
    anon=True,
    use_ssl=True,
    client_kwargs={&quot;endpoint_url&quot;: &quot;https://s3.central.data.destination-earth.eu&quot;})

s3fs_lumi = s3fs.S3FileSystem(
    anon=True,
    use_ssl=True,
    client_kwargs={&quot;endpoint_url&quot;: &quot;https://s3.lumi.data.destination-earth.eu&quot;})</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="2beBJ1oNVuzYqfPEsxkC6" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="PsXKuPnr6L" class="relative group/block"><p>We can list the data available at Central Site.</p></div><div id="yhcZf9dzfm" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">s3fs_central.ls(&quot;increment1-testdata&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="WAV4MT0RNXKX2x5zsC_6n" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>[&#x27;increment1-testdata/2022-08-30.zarr&#x27;, &#x27;increment1-testdata/built_data.zarr&#x27;]</span></code></div></div></div><div id="ZiObvXC3Cl" class="relative group/block"><p>Read data stored in S3 bucket at Central Site. The data we want to read is a single Zarr data store representing the GFM flood data over Pakistan for 2022-08-30.</p></div><div id="Iwn3ZFZD1j" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">flood_map = xr.open_zarr(store=s3fs.S3Map(root=f&quot;increment1-testdata/2022-08-30.zarr&quot;, s3=s3fs_central, check=False),
                         decode_coords=&quot;all&quot;,)[&quot;flood&quot;].assign_attrs(location=&quot;central&quot;, resolution=20)
#flood_map</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="HKL5SruuMf_ym8DyxNXul" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="L9kvKV1ncj" class="relative group/block"><p>We now want to run simple computation and compute the flooded area for the this day in August 2022.</p></div><div id="ncO2zve2wA" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">flooded_area_ = flood_map.sum()*20*20/1000.
#flooded_area_</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="_u2ixf95yNtu1Fzabt0jE" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="oYEfO6xpcq" class="relative group/block"><p>So far we haven’t computed anything, so lets do the computation now on the Dask cluster.</p></div><div id="XiNJZOkFRG" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">from rich.console import Console
from rich.prompt import Prompt
console = Console()

flooded_area = myDEDLClusters.compute(flooded_area_, sync=True)
console.print(f&quot;Flooded area: {flooded_area.data} km2&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="TrCDuf1PoUXYkxZ-8_z-3" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="qXNv9TOJLs" class="relative group/block"><p><strong>How was that processing routed to Dask Gateway at Central Site</strong>?</p><p><code>myDEDLClusters.compute(flooded_area_, sync=True)</code> checks for annotations (attributes) of array and maps that to available Dask Clusters.</p><p>Preprocess GFM data at <strong>Central Site</strong> for visualiation</p></div><div id="UTYwwF9fOU" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def preprocess_dataset(data_array: xr.DataArray, method: str):
    data_array = data_array.squeeze()
    steps = 500 // data_array.attrs[&quot;resolution&quot;]
    coarsened = data_array.coarsen({&#x27;y&#x27;: steps, &#x27;x&#x27;: steps}, boundary=&#x27;trim&#x27;)
    if method == &#x27;median&#x27;:
        data_array = (coarsened.median() &gt; 0).astype(&#x27;float32&#x27;)
    elif method == &#x27;mean&#x27;:
        data_array = coarsened.mean()
    elif method == &#x27;max&#x27;:
        data_array = coarsened.max()
    else:
        raise NotImplementedError(method)
    return data_array</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="KqU6ArYJvFSlREYEr9fvL" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="TJSAXflsz9" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">flood_prep_ = preprocess_dataset(flood_map, &#x27;median&#x27;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Msb4GVmX7Mmi38QD11vrk" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="pEZhfTefvR" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import numpy as np
flood_prep = myDEDLClusters.compute(flood_prep_, sync=True)
flood_prep.rio.write_crs(&quot;epsg:4326&quot;, inplace=True)
flood_prep = flood_prep.rio.reproject(f&quot;EPSG:3857&quot;, nodata=np.nan)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="MzXWEJrQ5htjZ3VzQx7ae" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="K1rypLRa8K" class="relative group/block"><p>Visualise flood data on map.</p></div><div id="K6cmnoGUop" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import leafmap
from attr import dataclass

@dataclass
class Extent:
    min_x: float
    min_y: float
    max_x: float
    max_y: float
    crs: str
    def get_center(self):
        return (np.mean([self.min_y, self.max_y]),
                np.mean([self.min_x,self.max_x]))


roi_extent = Extent(65, 21, 71, 31, crs=&#x27;EPSG:4326&#x27;)

m = leafmap.Map(center=roi_extent.get_center(),
                zoom=8, height=600)
m.add_raster(flood_prep, colormap=&quot;Blues&quot;, layer_name=&quot;Flood&quot;, nodata=0.)

m</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="qifPj6IWRvtHfnaU_y9tb" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="DT3Jy5d7Hx" class="relative group/block"><p>Read data stored in S3 bucket at LUMI bridge (Finland). Data we want to read is a datacube generated from ERA-5 representing predicted rainfall data.</p></div><div id="D6OiDnlT7i" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">rainfall = xr.open_zarr(store=s3fs.S3Map(root=f&quot;increment1-testdata/predicted_rainfall.zarr&quot;,
                                         s3=s3fs_lumi,
                                         check=False),
                        decode_coords=&quot;all&quot;,)[&quot;tp&quot;].assign_attrs(location=&quot;lumi&quot;, resolution=20)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="RHtk6cu02r5GcbCcYh9Ul" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="GSpZvhTwzq" class="relative group/block"><p>And again run the computation close to the data, therefore at <strong>LUMI bridge</strong>.</p><p>First we compute the accumulated rainfall over Pakistan.
Secondly we compute the average rainfall for August 2022 (monthly mean) at global scale.</p></div><div id="lwhcl7T70m" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">from datetime import datetime

def accum_rain_predictions(rain_data, startdate, enddate, extent):
    rain_ = rain_data.sel(time=slice(startdate, enddate),
                          latitude=slice(extent.max_y, extent.min_y),
                          longitude=slice(extent.min_x, extent.max_x))
    return rain_.cumsum(dim=&quot;time&quot;, keep_attrs=True)*1000

# compute accumulated rainfall over Pakistan
acc_rain_ = accum_rain_predictions(rainfall, startdate=datetime(2022, 8, 18),
                                                  enddate=datetime(2022, 8, 30),
                                                  extent=roi_extent)
acc_rain_ = acc_rain_.rename({&quot;longitude&quot;:&quot;x&quot;, &quot;latitude&quot;:&quot;y&quot;})</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="7rUd_01WBRJukGD_bPJ2f" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="jxUOG4FpoY" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">acc_rain = myDEDLClusters.compute(acc_rain_, sync=True)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="U7bpiOldpLymndZIE0nXd" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="XdecINO5vj" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def acc_rain_reproject(rain):
    from rasterio.enums import Resampling
    rain.rio.write_nodata(0, inplace=True)
    rain.rio.write_crs(&#x27;EPSG:4326&#x27;, inplace=True)
    return rain.rio.reproject(&#x27;EPSG:3857&#x27;, resolution=500, resampling=Resampling.bilinear)

acc_rain = acc_rain_reproject(acc_rain)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="V3jsbHJ_nWz_uEfPgqdzG" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="Y4HLPqnw1a" class="relative group/block"><p>Visualise forecast data provided by the Digital Twin which could have been used for flood risk assessment or even alerting.</p></div><div id="A7TTHgKQOQ" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">time_dim_len = acc_rain.shape[0]
for day in range(0, time_dim_len):
    fpath_str = f&quot;./{day}.tif&quot;
    acc_rain[day,:].rio.to_raster(fpath_str,
                                  driver=&quot;COG&quot;,
                                  overview_count=10)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="zq7jf947YmJ0OXj1GR0dW" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="T8quBKP097" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import leafmap
from localtileserver import get_leaflet_tile_layer

m = leafmap.Map(center=roi_extent.get_center(),
                zoom=6, height=600)

layer_dict = {}
date_vals = np.datetime_as_string(acc_rain[&quot;time&quot;].values, unit=&#x27;D&#x27;)
for day in range(0, time_dim_len):
    layer_dict[date_vals[day]]= get_leaflet_tile_layer(f&quot;./{day}.tif&quot;,
                                                       colormap=&quot;Blues&quot;,
                                                       indexes=[1],
                                                       nodata=0.,
                                                       vmin=acc_rain.min().values,
                                                       vmax=acc_rain.max().values,
                                                       opacity=0.85)

m.add_local_tile(flood_prep,
                 colormap=&quot;Blues&quot;,
                 nodata=0.)
m.add_time_slider(layer_dict,
                  layer=&quot;Accumluated Rainfall&quot;,
                  time_interval=1.)
m</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="BK6f94PZAUr2edIUogJrk" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="tYP4TAAftm" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">myDEDLClusters.shutdown()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="fN6YR8IEMiEJnH4N_UIld" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div></div><div class="flex pt-10 mb-10 space-x-4"><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="/gallery-2"><div class="flex h-full align-middle"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:-translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"></path></svg><div class="flex-grow text-right"><div class="text-xs text-gray-500 dark:text-gray-400">STACK</div>STACK Gallery</div></div></a><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="/stack-dask-101"><div class="flex h-full align-middle"><div class="flex-grow"><div class="text-xs text-gray-500 dark:text-gray-400">STACK</div>STACK service - Dask 101</div><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"></path></svg></div></a></div></main></article><script>((a,d)=>{if(!window.history.state||!window.history.state.key){let h=Math.random().toString(32).slice(2);window.history.replaceState({key:h},"")}try{let f=JSON.parse(sessionStorage.getItem(a)||"{}")[d||window.history.state.key];typeof f=="number"&&window.scrollTo(0,f)}catch(h){console.error(h),sessionStorage.removeItem(a)}})("positions", null)</script><link rel="modulepreload" href="/build/entry.client-UNPC4GT3.js"/><link rel="modulepreload" href="/build/_shared/chunk-OCTKKCIL.js"/><link rel="modulepreload" href="/build/_shared/chunk-UAI5KRM7.js"/><link rel="modulepreload" href="/build/_shared/chunk-2NH4LW52.js"/><link rel="modulepreload" href="/build/_shared/chunk-TMJFFFM7.js"/><link rel="modulepreload" href="/build/_shared/chunk-HBJK6BW3.js"/><link rel="modulepreload" href="/build/_shared/chunk-HYMQ7M2K.js"/><link rel="modulepreload" href="/build/_shared/chunk-OHOXABTA.js"/><link rel="modulepreload" href="/build/_shared/chunk-OCWQY3HK.js"/><link rel="modulepreload" href="/build/_shared/chunk-CPTH56EW.js"/><link rel="modulepreload" href="/build/_shared/chunk-3CVK3PYF.js"/><link rel="modulepreload" href="/build/_shared/chunk-J6FHCSRC.js"/><link rel="modulepreload" href="/build/_shared/chunk-S4SWV34C.js"/><link rel="modulepreload" href="/build/_shared/chunk-GUCIBHGO.js"/><link rel="modulepreload" href="/build/root-LMCDRB6W.js"/><link rel="modulepreload" href="/build/_shared/chunk-GOFUXLLW.js"/><link rel="modulepreload" href="/build/routes/$-SJYMRUNJ.js"/><script>window.__remixContext = {"url":"/stack-python-client-dask","state":{"loaderData":{"root":{"config":{"version":2,"myst":"1.3.28","options":{"logo":"/build/logo_bar-3bd55b7490dd93158f43624888cf0e4a.png","style":"/build/custom-da3cf1ae0accec587f226b4d9086177b.css"},"nav":[],"actions":[],"projects":[{"title":"DEDL notebook gallery","id":"e0a20a08-c498-4ecc-8022-c5f820333f35","toc":[{"file":"README.md"},{"children":[{"file":"HDA/README.md"},{"children":[{"file":"HDA/PySTAC/HDA-PyStac-Client.ipynb"},{"file":"HDA/DestinE_Digital_Twins/ExtremeDT-dataAvailability.ipynb"},{"file":"HDA/DestinE_Digital_Twins/DEDL-HDA-EO.ECMWF.DAT.DT_EXTREMES.ipynb"},{"file":"HDA/DestinE_Digital_Twins/ClimateDT-ParameterPlotter.ipynb"},{"file":"HDA/DestinE_Digital_Twins/ExtremeDT-ParameterPlotter.ipynb"},{"file":"HDA/DestinE_Digital_Twins/DEDL-HDA-EO.ECMWF.DAT.DT_CLIMATE-Series.ipynb"},{"file":"HDA/DestinE_Digital_Twins/DEDL-HDA-EO.ECMWF.DAT.DT_EXTREMES-Series.ipynb"},{"file":"HDA/DestinE_Digital_Twins/DEDL-HDA-EO.ECMWF.DAT.DT_CLIMATE.ipynb"},{"file":"HDA/CDS_data/DEDL-HDA-EO.ECMWF.DAT.REANALYSIS_ERA5_SINGLE_LEVELS.ipynb"},{"file":"HDA/EODAG/HDA-EODAG-quick-start.ipynb"},{"file":"HDA/EODAG/HDA-EODAG-full-version.ipynb"},{"file":"HDA/EUM_data/DEDL-HDA-EO.EUM.DAT.METOP.AVHRRL1.ipynb"},{"file":"HDA/EUM_data/DEDL-HDA-EO.EUM.DAT.SENTINEL-3.OL_1_ERR___.ipynb"},{"file":"HDA/Fresh_Data_Pool/DEDL-HDA-EO.ESA.DAT.SENTINEL-1.L1_GRD.ipynb"},{"file":"HDA/Fresh_Data_Pool/DEDL-HDA-EO.ESA.DAT.SENTINEL-2.MSI.L2A.ipynb"},{"file":"HDA/REST/HDA-REST-full-version.ipynb"},{"file":"HDA/REST/HDA-REST-Queryables.ipynb"},{"file":"HDA/REST/HDA-REST-quick-start.ipynb"}],"file":"HDA/gallery.md"}],"title":"HDA"},{"children":[{"file":"HOOK/README.md"},{"children":[{"file":"HOOK/Tutorial.ipynb"},{"file":"HOOK/DEDL-Hook_access.ipynb"}],"file":"HOOK/gallery.md"}],"title":"HOOK"},{"children":[{"file":"STACK/README.md"},{"children":[{"file":"STACK/STACK-Python-Client-Dask.ipynb"},{"file":"STACK/STACK-Dask-101.ipynb"},{"file":"STACK/ExtremeDT-DataCube.ipynb"},{"file":"STACK/ExtremeDT-DataCube-xViewer.ipynb"},{"file":"STACK/DEDL_StackService_Dask.ipynb"}],"file":"STACK/gallery.md"}],"title":"STACK"},{"children":[{"url":"https://katharinastarzer21.github.io/myst_DEDL_page/production/MYFIRSTTEST/","title":"My first Test"}],"title":"Cookbook Gallery"}],"thumbnail":"/build/DestinE-banner-25c00cbd0eb44a5aaf58adf7cf4a10ad.jpg","exports":[],"bibliography":[],"index":"index","pages":[{"level":1,"title":"HDA"},{"slug":"readme","title":"DestinE Harmonised Data Access (HDA)","description":"","date":"","thumbnail":"/build/DestinE-banner-25c00cbd0eb44a5aaf58adf7cf4a10ad.jpg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"gallery","title":"HDA Gallery","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"hda-pystac-client","title":"HDA PySTAC-Client Introduction","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"extremedt-dataavailability","title":"Extreme DT Data Availability","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"dedl-hda-eo-ecmwf-dat-dt-extremes","title":"Destination Earth - Weather-Induced Extremes Digital Twin - Data Access using DEDL HDA","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"climatedt-parameterplotter","title":"DEDL - HDA Climate DT Parameter Plotter - Tutorial","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"extremedt-parameterplotter","title":"DEDL - HDA Extreme DT Parameter Plotter - Tutorial","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"dedl-hda-eo-ecmwf-dat-dt-climate-series","title":"Destination Earth - Climate Change Adaptation Digital Twin Series Plot- Data Access using DEDL HDA","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"dedl-hda-eo-ecmwf-dat-dt-extremes-series","title":"Destination Earth - Weather-Induced Extremes Digital Twin - Data Access using DEDL HDA","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"dedl-hda-eo-ecmwf-dat-dt-climate","title":"Destination Earth - Climate Change Adaptation Digital Twin - Data Access using DEDL HDA","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"dedl-hda-eo-ecmwf-dat-reanalysis-era5-single-level","title":"Destination Earth - ERA5 hourly data on single levels from 1940 to present - Data Access using DEDL HDA","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"hda-eodag-quick-start","title":"DEDL - EODAG - A quick start with DEDL","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"hda-eodag-full-version","title":"DEDL - EODAG - DestinE Data Lake Provider (DEDL)","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"dedl-hda-eo-eum-dat-metop-avhrrl1","title":"Destination Earth - AVHRR Level 1B Metop Global - Data Access using DEDL HDA","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"dedl-hda-eo-eum-dat-sentinel-3-ol-1-err","title":"Destination Earth - OLCI Level 1B Reduced Resolution - Sentinel-3 - Data Access using DEDL HDA","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"dedl-hda-eo-esa-dat-sentinel-1-l1-grd","title":"Example of Using HDA to Find and Download Data for Urban Area Monitoring Using Sentinel-1 Data","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"dedl-hda-eo-esa-dat-sentinel-2-msi-l2a","title":"Example of how to use HDA to find and download data for conducting monitoring of Śniadrwy lake","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"hda-rest-full-version","title":"DEDL - HDA Tutorial","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"hda-rest-queryables","title":"DEDL - HDA Tutorial - Queryables","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"hda-rest-quick-start","title":"DEDL - HDA Tutorial - quick start","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"HOOK"},{"slug":"readme-1","title":"Hook Service","description":"","date":"","thumbnail":"/build/EUMETSAT-icon-35c5bf6f00a42bb69e5b27bc3eba1f7d.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"gallery-1","title":"HOOK Gallery","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"tutorial","title":"DEDL - Hook Tutorial - Data Harvest (data-harvest)","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"dedl-hook-access","title":"Access to Hook services","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"STACK"},{"slug":"readme-2","title":"STACK Service","description":"","date":"","thumbnail":"/build/DestinE-banner-25c00cbd0eb44a5aaf58adf7cf4a10ad.jpg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"gallery-2","title":"STACK Gallery","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"stack-python-client-dask","title":"STACK service - Python Client Dask","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"stack-dask-101","title":"STACK service - Dask 101","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"extremedt-datacube","title":"Data Cube populated with data obtained from Weather and Geophysical Extremes Digital Twin (DT) - ExtremeDT","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"extremedt-datacube-xviewer","title":"Create a dashboard based on Data Cube populated with data obtained from Weather and Geophysical Extremes Digital Twin (DT) - ExtremeDT","description":"","date":"","thumbnail":"/build/13671a697054e05ccbcc105d371ab38b.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"dedl-stackservice-dask","title":"DestinE Data Lake - Stack Service Dask","description":"","date":"","thumbnail":"/build/9aaf3e76d727ec891c8c02168fe0567d.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"Cookbook Gallery"}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static"},"routes/$":{"config":{"version":2,"myst":"1.3.28","options":{"logo":"/build/logo_bar-3bd55b7490dd93158f43624888cf0e4a.png","style":"/build/custom-da3cf1ae0accec587f226b4d9086177b.css"},"nav":[],"actions":[],"projects":[{"title":"DEDL notebook gallery","id":"e0a20a08-c498-4ecc-8022-c5f820333f35","toc":[{"file":"README.md"},{"children":[{"file":"HDA/README.md"},{"children":[{"file":"HDA/PySTAC/HDA-PyStac-Client.ipynb"},{"file":"HDA/DestinE_Digital_Twins/ExtremeDT-dataAvailability.ipynb"},{"file":"HDA/DestinE_Digital_Twins/DEDL-HDA-EO.ECMWF.DAT.DT_EXTREMES.ipynb"},{"file":"HDA/DestinE_Digital_Twins/ClimateDT-ParameterPlotter.ipynb"},{"file":"HDA/DestinE_Digital_Twins/ExtremeDT-ParameterPlotter.ipynb"},{"file":"HDA/DestinE_Digital_Twins/DEDL-HDA-EO.ECMWF.DAT.DT_CLIMATE-Series.ipynb"},{"file":"HDA/DestinE_Digital_Twins/DEDL-HDA-EO.ECMWF.DAT.DT_EXTREMES-Series.ipynb"},{"file":"HDA/DestinE_Digital_Twins/DEDL-HDA-EO.ECMWF.DAT.DT_CLIMATE.ipynb"},{"file":"HDA/CDS_data/DEDL-HDA-EO.ECMWF.DAT.REANALYSIS_ERA5_SINGLE_LEVELS.ipynb"},{"file":"HDA/EODAG/HDA-EODAG-quick-start.ipynb"},{"file":"HDA/EODAG/HDA-EODAG-full-version.ipynb"},{"file":"HDA/EUM_data/DEDL-HDA-EO.EUM.DAT.METOP.AVHRRL1.ipynb"},{"file":"HDA/EUM_data/DEDL-HDA-EO.EUM.DAT.SENTINEL-3.OL_1_ERR___.ipynb"},{"file":"HDA/Fresh_Data_Pool/DEDL-HDA-EO.ESA.DAT.SENTINEL-1.L1_GRD.ipynb"},{"file":"HDA/Fresh_Data_Pool/DEDL-HDA-EO.ESA.DAT.SENTINEL-2.MSI.L2A.ipynb"},{"file":"HDA/REST/HDA-REST-full-version.ipynb"},{"file":"HDA/REST/HDA-REST-Queryables.ipynb"},{"file":"HDA/REST/HDA-REST-quick-start.ipynb"}],"file":"HDA/gallery.md"}],"title":"HDA"},{"children":[{"file":"HOOK/README.md"},{"children":[{"file":"HOOK/Tutorial.ipynb"},{"file":"HOOK/DEDL-Hook_access.ipynb"}],"file":"HOOK/gallery.md"}],"title":"HOOK"},{"children":[{"file":"STACK/README.md"},{"children":[{"file":"STACK/STACK-Python-Client-Dask.ipynb"},{"file":"STACK/STACK-Dask-101.ipynb"},{"file":"STACK/ExtremeDT-DataCube.ipynb"},{"file":"STACK/ExtremeDT-DataCube-xViewer.ipynb"},{"file":"STACK/DEDL_StackService_Dask.ipynb"}],"file":"STACK/gallery.md"}],"title":"STACK"},{"children":[{"url":"https://katharinastarzer21.github.io/myst_DEDL_page/production/MYFIRSTTEST/","title":"My first Test"}],"title":"Cookbook Gallery"}],"thumbnail":"/build/DestinE-banner-25c00cbd0eb44a5aaf58adf7cf4a10ad.jpg","exports":[],"bibliography":[],"index":"index","pages":[{"level":1,"title":"HDA"},{"slug":"readme","title":"DestinE Harmonised Data Access (HDA)","description":"","date":"","thumbnail":"/build/DestinE-banner-25c00cbd0eb44a5aaf58adf7cf4a10ad.jpg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"gallery","title":"HDA Gallery","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"hda-pystac-client","title":"HDA PySTAC-Client Introduction","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"extremedt-dataavailability","title":"Extreme DT Data Availability","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"dedl-hda-eo-ecmwf-dat-dt-extremes","title":"Destination Earth - Weather-Induced Extremes Digital Twin - Data Access using DEDL HDA","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"climatedt-parameterplotter","title":"DEDL - HDA Climate DT Parameter Plotter - Tutorial","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"extremedt-parameterplotter","title":"DEDL - HDA Extreme DT Parameter Plotter - Tutorial","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"dedl-hda-eo-ecmwf-dat-dt-climate-series","title":"Destination Earth - Climate Change Adaptation Digital Twin Series Plot- Data Access using DEDL HDA","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"dedl-hda-eo-ecmwf-dat-dt-extremes-series","title":"Destination Earth - Weather-Induced Extremes Digital Twin - Data Access using DEDL HDA","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"dedl-hda-eo-ecmwf-dat-dt-climate","title":"Destination Earth - Climate Change Adaptation Digital Twin - Data Access using DEDL HDA","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"dedl-hda-eo-ecmwf-dat-reanalysis-era5-single-level","title":"Destination Earth - ERA5 hourly data on single levels from 1940 to present - Data Access using DEDL HDA","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"hda-eodag-quick-start","title":"DEDL - EODAG - A quick start with DEDL","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"hda-eodag-full-version","title":"DEDL - EODAG - DestinE Data Lake Provider (DEDL)","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"dedl-hda-eo-eum-dat-metop-avhrrl1","title":"Destination Earth - AVHRR Level 1B Metop Global - Data Access using DEDL HDA","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"dedl-hda-eo-eum-dat-sentinel-3-ol-1-err","title":"Destination Earth - OLCI Level 1B Reduced Resolution - Sentinel-3 - Data Access using DEDL HDA","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"dedl-hda-eo-esa-dat-sentinel-1-l1-grd","title":"Example of Using HDA to Find and Download Data for Urban Area Monitoring Using Sentinel-1 Data","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"dedl-hda-eo-esa-dat-sentinel-2-msi-l2a","title":"Example of how to use HDA to find and download data for conducting monitoring of Śniadrwy lake","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"hda-rest-full-version","title":"DEDL - HDA Tutorial","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"hda-rest-queryables","title":"DEDL - HDA Tutorial - Queryables","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"hda-rest-quick-start","title":"DEDL - HDA Tutorial - quick start","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"HOOK"},{"slug":"readme-1","title":"Hook Service","description":"","date":"","thumbnail":"/build/EUMETSAT-icon-35c5bf6f00a42bb69e5b27bc3eba1f7d.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"gallery-1","title":"HOOK Gallery","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"tutorial","title":"DEDL - Hook Tutorial - Data Harvest (data-harvest)","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"dedl-hook-access","title":"Access to Hook services","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"STACK"},{"slug":"readme-2","title":"STACK Service","description":"","date":"","thumbnail":"/build/DestinE-banner-25c00cbd0eb44a5aaf58adf7cf4a10ad.jpg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"gallery-2","title":"STACK Gallery","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"stack-python-client-dask","title":"STACK service - Python Client Dask","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"stack-dask-101","title":"STACK service - Dask 101","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"extremedt-datacube","title":"Data Cube populated with data obtained from Weather and Geophysical Extremes Digital Twin (DT) - ExtremeDT","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"extremedt-datacube-xviewer","title":"Create a dashboard based on Data Cube populated with data obtained from Weather and Geophysical Extremes Digital Twin (DT) - ExtremeDT","description":"","date":"","thumbnail":"/build/13671a697054e05ccbcc105d371ab38b.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"dedl-stackservice-dask","title":"DestinE Data Lake - Stack Service Dask","description":"","date":"","thumbnail":"/build/9aaf3e76d727ec891c8c02168fe0567d.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"Cookbook Gallery"}]}]},"page":{"version":2,"kind":"Notebook","sha256":"af1af1743f5c9b0501cd04dc536e7303f3f47972e110c129da6370ed31d1cd18","slug":"stack-python-client-dask","location":"/STACK/STACK-Python-Client-Dask.ipynb","dependencies":[],"frontmatter":{"title":"STACK service - Python Client Dask","content_includes_title":true,"kernelspec":{"name":"python_dedl","display_name":"Python DEDL","language":"python"},"numbering":{"title":{"offset":2}},"thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","exports":[{"format":"ipynb","filename":"STACK-Python-Client-Dask.ipynb","url":"/build/STACK-Python-Client--fdeaaefe1ae29f6821b9a98df7dbb2c9.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"image","url":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"O5ujZH6IgS","urlSource":"https://github.com/destination-earth/DestinE-DataLake-Lab/blob/main/img/DestinE-banner.jpg?raw=true"}],"key":"X9Hz2zT7bp"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Licence","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"H4bZ0egnT9"}],"key":"FGYHIyErGM"},{"type":"text","value":": MIT ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wuNAK67aB7"},{"type":"break","key":"MaooRNYIpq"}],"key":"qFlF4b0jbc"},{"type":"image","url":"/build/2b00998ddd74a039529882b6d26ca076.svg","alt":"Dask logo","key":"eRKCJMLaQb","urlSource":"https://docs.dask.org/en/latest/_images/dask_horizontal.svg"},{"type":"heading","depth":1,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"STACK service - Python Client Dask","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"p2idSDeY4h"}],"identifier":"stack-service-python-client-dask","label":"STACK service - Python Client Dask","html_id":"stack-service-python-client-dask","implicit":true,"key":"LJeXGMxPiG"},{"type":"heading","depth":1,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Multi-cloud processing with Dask","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Igj7wQyEkY"}],"identifier":"multi-cloud-processing-with-dask","label":"Multi-cloud processing with Dask","html_id":"multi-cloud-processing-with-dask","implicit":true,"key":"J3JgJK8JeX"},{"type":"div","class":"alert-info","children":[{"type":"heading","depth":3,"children":[{"type":"text","value":"Overview","key":"gPlN0CBoqD"}],"identifier":"overview","label":"Overview","html_id":"overview","implicit":true,"key":"p3yZpl1ytB"},{"type":"heading","depth":4,"children":[{"type":"text","value":"Content","key":"jfKTDsFDw0"}],"identifier":"content","label":"Content","html_id":"content","implicit":true,"key":"tge2SnUljK"},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"DestinE Data Lake (DEDL) Stack Client","key":"Gxdjd5O8sA"}],"key":"AMUeqjwjZG"}],"key":"x73rNdUPRv"},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Making use of clients context manager","key":"fXlYUjfex5"}],"key":"xAEbjsBVId"}],"key":"nIzQ91beWt"},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Use Case: Pakistan Flood 2022","key":"eIC7C4orLb"}],"key":"Ia7X7ExbN5"}],"key":"Vc6PRmPCCU"},{"type":"heading","depth":4,"children":[{"type":"text","value":"Duration: 15 min.","key":"UFJSYHMlLM"}],"identifier":"duration-15-min","label":"Duration: 15 min.","html_id":"duration-15-min","implicit":true,"key":"VYhQQsP84h"}],"key":"TNXrjPuqzt"},{"type":"break","key":"hPF38VHQVv"},{"type":"div","class":"alert-warning","children":[{"type":"text","value":"Please make sure Python DEDL kernel is used.","key":"hHxCK5ffmu"}],"key":"RxrqTfttmO"},{"type":"paragraph","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"DestinE Data Lake utilises a deployment of ","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"QHOYm1ikzV"},{"type":"link","url":"https://gateway.dask.org/","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Dask Gateway","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"cwJ1oGor6D"}],"urlSource":"https://gateway.dask.org/","key":"B9EFkjuvgU"},{"type":"text","value":" on each location (bridge) in the data lake. Dask Gateway provides a secure, multi-tenant server for managing Dask clusters. It allows users to launch and use Dask clusters in a shared, centrally managed cluster environment, without requiring users to have direct access to the underlying cluster backend (e.g. Kubernetes, Hadoop/YARN, HPC Job queues, etc…).","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"S2ks1aFfIg"}],"key":"wdnCzFVa28"},{"type":"paragraph","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"Dask Gateway exposes a REST API to spawn clusters on demand. The overall architecture of Dask Gateway is depicted hereafter.","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"qgRqP75Zm2"}],"key":"H5zifLTQVt"},{"type":"image","url":"/build/01f61b2ebec9f77ff63c7f40d6a20edc.png","key":"dzhLh16tUL","urlSource":"https://github.com/destination-earth/DestinE-DataLake-Lab/blob/main/STACK/img/DEDL_Dask_multicloud.png?raw=true"},{"type":"heading","depth":2,"position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"DEDL Dask Gateway","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"QCTjA93Obt"}],"identifier":"dedl-dask-gateway","label":"DEDL Dask Gateway","html_id":"dedl-dask-gateway","implicit":true,"key":"ELKdOUQG9c"},{"type":"paragraph","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"strong","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"text","value":"Central Site","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"elIc63fCs8"}],"key":"xUIZqOMBxY"}],"key":"oYQ7VNkDkY"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":30,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"address: ","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"FU28X2QsjO"},{"type":"link","url":"http://dask.central.data.destination-earth.eu","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"http://​dask​.central​.data​.destination​-earth​.eu","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"DeQrN28zlL"}],"urlSource":"http://dask.central.data.destination-earth.eu","key":"IpEfqJdaZe"}],"key":"BU6ikuTmUX"},{"type":"listItem","spread":true,"position":{"start":{"line":31,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"text","value":"proxy_address: tcp://dask.central.data.destination-earth.eu:80","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"B2Kv9WrbCD"}],"key":"ZSqSCgSlPE"}],"key":"NLCCSoNE2Y"},{"type":"paragraph","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"strong","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"text","value":"LUMI Bridge","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"QZjqGLO8NY"}],"key":"ogNDpn2yK7"}],"key":"h50geV6RaH"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":34,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"address: ","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"sMMMxIoBqd"},{"type":"link","url":"http://dask.lumi.data.destination-earth.eu","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"http://​dask​.lumi​.data​.destination​-earth​.eu","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"VcLSE0C4pt"}],"urlSource":"http://dask.lumi.data.destination-earth.eu","key":"QsFnlUbsIL"}],"key":"i4y2kS09ly"},{"type":"listItem","spread":true,"position":{"start":{"line":35,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"proxy_address: tcp://dask.lumi.data.destination-earth.eu:80","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"QDakmDFbbb"}],"key":"iRtRbkm5Ad"}],"key":"wi7I2KLjX5"},{"type":"paragraph","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"text","value":"Only authenticated access is granted to the DEDL STACK service Dask, therefore a helper class to authenticate a user against the DESP identity management system is implemented. The users password is directly handed over to the request object and is not permanently stored.","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"ZSNPVTFiEz"}],"key":"PuNDviKncy"},{"type":"paragraph","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"text","value":"In the following, please enter your DESP username and password. Again, the password will only be saved for the duration of this user session and will be remove as soon as the notebook/kernel is closed.","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"jw7Ritqa3m"}],"key":"Q7sKI732aG"}],"key":"yqMCgxIsc9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from dask_gateway.auth import GatewayAuth\nfrom getpass import getpass\nfrom destinelab import AuthHandler as DESP_AuthHandler\n\nclass DESPAuth(GatewayAuth):\n    def __init__(self, username: str):\n        self.auth_handler = DESP_AuthHandler(username, getpass(\"Please input your DESP password: \"))\n        self.access_token = self.auth_handler.get_token()\n    \n    def pre_request(self, _):\n        headers = {\"Authorization\": \"Bearer \" + self.access_token}\n        return headers, None","key":"AAMLPFUvuU"},{"type":"output","id":"ZniJ2TSoJiLqfgEnIq6Eq","data":[],"key":"mkFjLca30w"}],"key":"rftSVRKHn7"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from rich.prompt import Prompt\nmyAuth = DESPAuth(username=Prompt.ask(prompt=\"Username\"))","visibility":"show","key":"ZgyS7aRuYR"},{"type":"output","id":"suG2ObOjQ_Wf9_YLjabvP","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"\u003cpre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"\u003eUsername: \u003c/pre\u003e\n","content_type":"text/html"},"text/plain":{"content":"Username: ","content_type":"text/plain"}}},{"name":"stdout","output_type":"stream","text":" christoph.reimer\nPlease input your DESP password:  ········\n"},{"name":"stdout","output_type":"stream","text":"Response code: 200\n"}],"visibility":"show","key":"robtltcgh1"}],"visibility":"show","key":"wu5JyivJEr"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"DestinE Data Lake (DEDL) Stack Client","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iFqI5feNBj"}],"identifier":"destine-data-lake-dedl-stack-client","label":"DestinE Data Lake (DEDL) Stack Client","html_id":"destine-data-lake-dedl-stack-client","implicit":true,"key":"TlJe3uDDGu"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"bN6H1ltgSr"},{"type":"link","url":"https://github.com/destination-earth/DestinE_EUMETSAT_DEDL_Stack_Client","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"DEDL Stack Client is a Python","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"wObQuxONQV"}],"urlSource":"https://github.com/destination-earth/DestinE_EUMETSAT_DEDL_Stack_Client","error":true,"key":"dso5tHJa1S"},{"type":"text","value":" library to facilitate the use of Stack Service Dask. The main objective is to provide an abstraction layer to interact with the various clusters on each DEDL bridge. Computations can be directed to the different Dask clusters by making use of a context manager as given in the following.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"z3Tsndirhk"}],"key":"MnZLPnptlQ"}],"key":"jFOT60arzL"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from dedl_stack_client.dask import DaskMultiCluster\n\nmyDEDLClusters = DaskMultiCluster(auth=myAuth)\nmyDEDLClusters.new_cluster()","visibility":"show","key":"JaxHXvKR6R"},{"type":"output","id":"miC0hhlfqq564od_uSM3q","data":[{"name":"stdout","output_type":"stream","text":"Create new cluster for Central Site\nCreate new cluster for LUMI Bridge\n"}],"visibility":"show","key":"o4LxNYCfA3"}],"visibility":"show","key":"L0O8FiPx79"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"myDEDLClusters.get_cluster_url()","visibility":"show","key":"AK0NXYhwOW"},{"type":"output","id":"NAKryh4TPJLmr_i6Z9uoo","data":[{"name":"stdout","output_type":"stream","text":"http://dask.central.data.destination-earth.eu/clusters/dask-gateway.203d0155443945c986a35b0488db7ebb/status\nhttp://dask.lumi.data.destination-earth.eu/clusters/dask-gateway.9010455c0c8a44df9a52e15003252889/status\n"}],"visibility":"show","key":"fitoJjUeS6"}],"visibility":"show","key":"Y3xX5Og0s2"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"We can again showcase the execution of standard Python functions on the remote clusters.\nIn the following we will make use of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"u8OKmEgTaj"},{"type":"inlineCode","value":"dask.futures","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Rfb330NBQP"},{"type":"text","value":", non-blocking distributed calculations, utilising the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ggdtrBvNTX"},{"type":"inlineCode","value":"map()","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"L3dkhflv0p"},{"type":"text","value":" method for task distribution. Detailed information about ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AUQIaOkxYp"},{"type":"inlineCode","value":"dask.futures","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UVlIGzDsaU"},{"type":"text","value":" can be found on the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EXn3FUTvZ3"},{"type":"link","url":"https://docs.dask.org/en/stable/futures.html","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Dask documention","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UMOqXZIGR6"}],"urlSource":"https://docs.dask.org/en/stable/futures.html","key":"ZvJfdsz1qT"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"q2QFhRLtjd"}],"key":"NkjxfUdWXz"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"This approach allows for embarrassingly parallel task scheduling, which is very similar to Function as a Service capabilities.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"EeNmTmoj1u"}],"key":"rqtDNl8QkL"},{"type":"image","url":"/build/a3e154464638fb32cf560b6de9c384d8.svg","key":"IL3e7ISz7N","urlSource":"https://docs.dask.org/en/latest/_images/map-reduce-task-scheduling.svg"}],"key":"f4ARnUzT4k"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from time import sleep as wait\n\ndef apply_myfunc(x):\n    wait(1)\n    return x+1","visibility":"show","key":"Kab8h815Yz"},{"type":"output","id":"YimdDUmYnrcEjyv9sPRGM","data":[],"visibility":"show","key":"ojYNWcsYzG"}],"visibility":"show","key":"RpXj4mXsBv"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We want to run ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IXxN2fADl2"},{"type":"inlineCode","value":"apply_myfunc()","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eagFwIxJI7"},{"type":"text","value":" on ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZQ67oUP9ha"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Central Site","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"f08kPLnvQi"}],"key":"sFHxPnznbQ"},{"type":"text","value":" and wait for all results to be ready. ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"edXfIvGwRe"},{"type":"inlineCode","value":"my_filelist_central","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rNCbzCsUIi"},{"type":"text","value":" represents a filelist to be processed by ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"T4sPe370Fh"},{"type":"inlineCode","value":"apply_myfunc()","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TxNQArA8IU"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SMpXc97KcR"}],"key":"CdNWrCtEEj"}],"key":"SBnGTOFrgv"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"my_filelist_central = range(20)\nwith myDEDLClusters.as_current(location=\"central\") as myclient:\n    central_future = myclient.map(apply_myfunc, my_filelist_central)\n    results_central = myclient.gather(central_future)","visibility":"show","key":"Q5704lQmc5"},{"type":"output","id":"Gw9G38OPXt-X5A2ziCnAz","data":[],"visibility":"show","key":"WeUWYlkwiW"}],"visibility":"show","key":"eTIAFmO9ax"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"results_central","visibility":"show","key":"sXZeX1tgwf"},{"type":"output","id":"JF2_pWnlr3L6pKOgfq3YR","data":[{"output_type":"execute_result","execution_count":24,"metadata":{},"data":{"text/plain":{"content":"[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]","content_type":"text/plain"}}}],"visibility":"show","key":"sdMdOm2faC"}],"visibility":"show","key":"T9W1b0t6gA"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Run computation at ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hbkwgTTyWp"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"LUMI bridge","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WpSEvQ1HCB"}],"key":"XcwONYGy4u"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HkaXVPNBF4"}],"key":"TaYczxrhgV"}],"key":"hyTKkPGiQy"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"my_filelist_lumi = range(32)\nwith myDEDLClusters.as_current(location=\"lumi\") as myclient:\n    lumi_future = myclient.map(apply_myfunc, my_filelist_lumi)\n    results_lumi = myclient.gather(lumi_future)","visibility":"show","key":"ZrLdE6BjnO"},{"type":"output","id":"nWG8IX4eCWfKsy2hMNavi","data":[],"visibility":"show","key":"udiBT36dDB"}],"visibility":"show","key":"Bu3GsG2VWy"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"results_lumi","visibility":"show","key":"GdW0a1ovtg"},{"type":"output","id":"3VyqZmH27R2z-F0o7C_lB","data":[{"output_type":"execute_result","execution_count":26,"metadata":{},"data":{"text/plain":{"content":"[1,\n 2,\n 3,\n 4,\n 5,\n 6,\n 7,\n 8,\n 9,\n 10,\n 11,\n 12,\n 13,\n 14,\n 15,\n 16,\n 17,\n 18,\n 19,\n 20,\n 21,\n 22,\n 23,\n 24,\n 25,\n 26,\n 27,\n 28,\n 29,\n 30,\n 31,\n 32]","content_type":"text/plain"}}}],"visibility":"show","key":"RGniuCrGxe"}],"visibility":"show","key":"fGXzm7sZ94"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Limitations","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"knjeq1TM8S"}],"identifier":"limitations","label":"Limitations","html_id":"limitations","implicit":true,"key":"DZoWrEHCft"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Python libraries use in the local environment need to match, same version, with those available in the Dask Cluster. If this is not the case, you will get a warning, code might work but not guaranteed.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ot9sCBmWU6"}],"key":"J8CE5112US"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"No direct data exchange between Dask Workers across cloud locations possible. Each location acts as atmoic unit, however data can be easily exchanged via storage services such as S3.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"df4VQ73uta"}],"key":"oZytZ6FfhS"}],"key":"IOAH4DNpM3"}],"key":"LqJWIVAA57"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Use Case example: Pakistan Flood 2022","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TVNq3GCn2y"}],"identifier":"use-case-example-pakistan-flood-2022","label":"Use Case example: Pakistan Flood 2022","html_id":"use-case-example-pakistan-flood-2022","implicit":true,"key":"r98OjgpTzl"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The complete use case is available on GitHub via ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"yvY4MIFiIv"},{"type":"link","url":"https://github.com/destination-earth/DestinE_EUMETSAT_PakistanFlood_2022","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"https://​github​.com​/destination​-earth​/DestinE​_EUMETSAT​_PakistanFlood​_2022","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"aEFB0UCYoX"}],"urlSource":"https://github.com/destination-earth/DestinE_EUMETSAT_PakistanFlood_2022","error":true,"key":"pjWxA55DNc"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"OwbkZuDLBX"}],"key":"hlZXcdKei4"}],"key":"bl9phIN6zx"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The use case demonstrates the multi-cloud capabilities of DEDL following the paradigm of data proximate computing. Data of the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Zg40df33UB"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Global Flood Monitoring (GFM)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"cN0qbCqYvN"}],"key":"JdGdQ94YH8"},{"type":"text","value":" service as well as ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"YRym2lnLEV"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Climate DT outputs, simulated by utilising ERA5 data","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"YxbFoLei0Z"}],"key":"q5us5we8kG"},{"type":"text","value":" have been use for flood risk assessment.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"kYZ9nGfZaw"}],"key":"GfU9TgHka5"},{"type":"image","url":"/build/fbe7b3a93dbabd237a3b9af41be26621.png","key":"Pjjq8OThIJ","urlSource":"https://github.com/destination-earth/DestinE_EUMETSAT_PakistanFlood_2022/blob/main/img/DEDL_FloodUC_dataflow.png?raw=true"}],"key":"AyCOrZSKHL"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Data is stored as datacubes (zarr format) at Central Site and at LUMI bridge in object storage.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ITtxviTOYX"}],"key":"J9Suqi9nu3"}],"key":"IStM7f0RHH"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"import s3fs\nimport xarray as xr\n\nxr.set_options(keep_attrs=True)\n\ns3fs_central = s3fs.S3FileSystem(\n    anon=True,\n    use_ssl=True,\n    client_kwargs={\"endpoint_url\": \"https://s3.central.data.destination-earth.eu\"})\n\ns3fs_lumi = s3fs.S3FileSystem(\n    anon=True,\n    use_ssl=True,\n    client_kwargs={\"endpoint_url\": \"https://s3.lumi.data.destination-earth.eu\"})","visibility":"show","key":"Tns1caP8i1"},{"type":"output","id":"2beBJ1oNVuzYqfPEsxkC6","data":[],"visibility":"show","key":"kFmsOLyKRO"}],"visibility":"show","key":"aYIgWWNsml"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can list the data available at Central Site.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hLD2wJBDzZ"}],"key":"KDMQ2IjMRB"}],"key":"PsXKuPnr6L"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"s3fs_central.ls(\"increment1-testdata\")","visibility":"show","key":"fCqNmnSDiR"},{"type":"output","id":"WAV4MT0RNXKX2x5zsC_6n","data":[{"output_type":"execute_result","execution_count":28,"metadata":{},"data":{"text/plain":{"content":"['increment1-testdata/2022-08-30.zarr', 'increment1-testdata/built_data.zarr']","content_type":"text/plain"}}}],"visibility":"show","key":"tUEXsgwLel"}],"visibility":"show","key":"yhcZf9dzfm"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Read data stored in S3 bucket at Central Site. The data we want to read is a single Zarr data store representing the GFM flood data over Pakistan for 2022-08-30.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DED4s0IAxd"}],"key":"Q49GNFIO24"}],"key":"ZiObvXC3Cl"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"flood_map = xr.open_zarr(store=s3fs.S3Map(root=f\"increment1-testdata/2022-08-30.zarr\", s3=s3fs_central, check=False),\n                         decode_coords=\"all\",)[\"flood\"].assign_attrs(location=\"central\", resolution=20)\n#flood_map","visibility":"show","key":"ywi1QKB5xc"},{"type":"output","id":"HKL5SruuMf_ym8DyxNXul","data":[],"visibility":"show","key":"LuQH3LWaLi"}],"visibility":"show","key":"Iwn3ZFZD1j"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We now want to run simple computation and compute the flooded area for the this day in August 2022.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IMQVo08ccS"}],"key":"L39MRBHzrk"}],"key":"L9kvKV1ncj"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"flooded_area_ = flood_map.sum()*20*20/1000.\n#flooded_area_","visibility":"show","key":"wuVAKz5mrr"},{"type":"output","id":"_u2ixf95yNtu1Fzabt0jE","data":[],"visibility":"show","key":"jHr0hujDRE"}],"visibility":"show","key":"ncO2zve2wA"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"So far we haven’t computed anything, so lets do the computation now on the Dask cluster.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TimVxsDqx6"}],"key":"r2rSfc6JYJ"}],"key":"oYEfO6xpcq"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from rich.console import Console\nfrom rich.prompt import Prompt\nconsole = Console()\n\nflooded_area = myDEDLClusters.compute(flooded_area_, sync=True)\nconsole.print(f\"Flooded area: {flooded_area.data} km2\")","visibility":"show","key":"jKIAP5MP4q"},{"type":"output","id":"TrCDuf1PoUXYkxZ-8_z-3","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"\u003cpre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"\u003eFlooded area: \u003cspan style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\"\u003e18991614.0\u003c/span\u003e km2\n\u003c/pre\u003e\n","content_type":"text/html"},"text/plain":{"content":"Flooded area: \u001b[1;36m18991614.0\u001b[0m km2\n","content_type":"text/plain"}}}],"visibility":"show","key":"HQb5yIJF8X"}],"visibility":"show","key":"XiNJZOkFRG"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"How was that processing routed to Dask Gateway at Central Site","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sgrZ25VnVM"}],"key":"Hp2VUBwkZ7"},{"type":"text","value":"?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aBT4xjcTYq"}],"key":"JKKN6YEUkK"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"inlineCode","value":"myDEDLClusters.compute(flooded_area_, sync=True)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"XHErz7NL4t"},{"type":"text","value":" checks for annotations (attributes) of array and maps that to available Dask Clusters.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"HqNXSSv6HC"}],"key":"VVdhpADjTY"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Preprocess GFM data at ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"chZweIJRF3"},{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Central Site","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"sdE1C4x8OO"}],"key":"CJhj0NZQf0"},{"type":"text","value":" for visualiation","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"sMNRJQ0m9v"}],"key":"gEib0HkV21"}],"key":"qXNv9TOJLs"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"def preprocess_dataset(data_array: xr.DataArray, method: str):\n    data_array = data_array.squeeze()\n    steps = 500 // data_array.attrs[\"resolution\"]\n    coarsened = data_array.coarsen({'y': steps, 'x': steps}, boundary='trim')\n    if method == 'median':\n        data_array = (coarsened.median() \u003e 0).astype('float32')\n    elif method == 'mean':\n        data_array = coarsened.mean()\n    elif method == 'max':\n        data_array = coarsened.max()\n    else:\n        raise NotImplementedError(method)\n    return data_array","visibility":"show","key":"PNStWv4MSP"},{"type":"output","id":"KqU6ArYJvFSlREYEr9fvL","data":[],"visibility":"show","key":"meWaOz3KDn"}],"visibility":"show","key":"UTYwwF9fOU"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"flood_prep_ = preprocess_dataset(flood_map, 'median')","visibility":"show","key":"eg8ECBRhBl"},{"type":"output","id":"Msb4GVmX7Mmi38QD11vrk","data":[],"visibility":"show","key":"B5jViSScuP"}],"visibility":"show","key":"TJSAXflsz9"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nflood_prep = myDEDLClusters.compute(flood_prep_, sync=True)\nflood_prep.rio.write_crs(\"epsg:4326\", inplace=True)\nflood_prep = flood_prep.rio.reproject(f\"EPSG:3857\", nodata=np.nan)","visibility":"show","key":"aq0jkhUrqy"},{"type":"output","id":"MzXWEJrQ5htjZ3VzQx7ae","data":[],"visibility":"show","key":"fRPhjSI7WR"}],"visibility":"show","key":"pEZhfTefvR"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Visualise flood data on map.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tZa4mHH6bO"}],"key":"DPGq9PuuXK"}],"key":"K1rypLRa8K"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"import leafmap\nfrom attr import dataclass\n\n@dataclass\nclass Extent:\n    min_x: float\n    min_y: float\n    max_x: float\n    max_y: float\n    crs: str\n    def get_center(self):\n        return (np.mean([self.min_y, self.max_y]),\n                np.mean([self.min_x,self.max_x]))\n\n\nroi_extent = Extent(65, 21, 71, 31, crs='EPSG:4326')\n\nm = leafmap.Map(center=roi_extent.get_center(),\n                zoom=8, height=600)\nm.add_raster(flood_prep, colormap=\"Blues\", layer_name=\"Flood\", nodata=0.)\n\nm","visibility":"show","key":"FxIpghTTqi"},{"type":"output","id":"qifPj6IWRvtHfnaU_y9tb","data":[{"output_type":"execute_result","execution_count":64,"metadata":{},"data":{"application/vnd.jupyter.widget-view+json":{"content":"{\"model_id\":\"8b9c7249181848be8d4dd6f40304ec7b\",\"version_major\":2,\"version_minor\":0}","content_type":"application/vnd.jupyter.widget-view+json"},"text/plain":{"content":"Map(center=[26.0, 68.0], controls=(ZoomControl(options=['position', 'zoom_in_text', 'zoom_in_title', 'zoom_out…","content_type":"text/plain"}}}],"visibility":"show","key":"SsW8A02OiG"}],"visibility":"show","key":"K6cmnoGUop"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Read data stored in S3 bucket at LUMI bridge (Finland). Data we want to read is a datacube generated from ERA-5 representing predicted rainfall data.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qJCjn4mTDa"}],"key":"p7q3j0EcZA"}],"key":"DT3Jy5d7Hx"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"rainfall = xr.open_zarr(store=s3fs.S3Map(root=f\"increment1-testdata/predicted_rainfall.zarr\",\n                                         s3=s3fs_lumi,\n                                         check=False),\n                        decode_coords=\"all\",)[\"tp\"].assign_attrs(location=\"lumi\", resolution=20)","visibility":"show","key":"dwxekPvURh"},{"type":"output","id":"RHtk6cu02r5GcbCcYh9Ul","data":[],"visibility":"show","key":"lUNtKAv9vN"}],"visibility":"show","key":"D6OiDnlT7i"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"And again run the computation close to the data, therefore at ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mhPqdty2ih"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"LUMI bridge","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rn5E1JTVrV"}],"key":"gRGoF0tjvO"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FchzwI4Htf"}],"key":"zHobl80nfa"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"First we compute the accumulated rainfall over Pakistan.\nSecondly we compute the average rainfall for August 2022 (monthly mean) at global scale.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"gILIfYD1xn"}],"key":"IgK4FCIZut"}],"key":"GSpZvhTwzq"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from datetime import datetime\n\ndef accum_rain_predictions(rain_data, startdate, enddate, extent):\n    rain_ = rain_data.sel(time=slice(startdate, enddate),\n                          latitude=slice(extent.max_y, extent.min_y),\n                          longitude=slice(extent.min_x, extent.max_x))\n    return rain_.cumsum(dim=\"time\", keep_attrs=True)*1000\n\n# compute accumulated rainfall over Pakistan\nacc_rain_ = accum_rain_predictions(rainfall, startdate=datetime(2022, 8, 18),\n                                                  enddate=datetime(2022, 8, 30),\n                                                  extent=roi_extent)\nacc_rain_ = acc_rain_.rename({\"longitude\":\"x\", \"latitude\":\"y\"})","visibility":"show","key":"Vp4ixZoCyF"},{"type":"output","id":"7rUd_01WBRJukGD_bPJ2f","data":[],"visibility":"show","key":"vhwEylccVg"}],"visibility":"show","key":"lwhcl7T70m"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"acc_rain = myDEDLClusters.compute(acc_rain_, sync=True)","visibility":"show","key":"gEMz8YAHCH"},{"type":"output","id":"U7bpiOldpLymndZIE0nXd","data":[],"visibility":"show","key":"mT4zefAELv"}],"visibility":"show","key":"jxUOG4FpoY"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"def acc_rain_reproject(rain):\n    from rasterio.enums import Resampling\n    rain.rio.write_nodata(0, inplace=True)\n    rain.rio.write_crs('EPSG:4326', inplace=True)\n    return rain.rio.reproject('EPSG:3857', resolution=500, resampling=Resampling.bilinear)\n\nacc_rain = acc_rain_reproject(acc_rain)","visibility":"show","key":"IcRE3ol2fd"},{"type":"output","id":"V3jsbHJ_nWz_uEfPgqdzG","data":[],"visibility":"show","key":"WlHREp4TLh"}],"visibility":"show","key":"XdecINO5vj"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Visualise forecast data provided by the Digital Twin which could have been used for flood risk assessment or even alerting.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OHrtwJUt0N"}],"key":"Q1c4a7tzxG"}],"key":"Y4HLPqnw1a"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"time_dim_len = acc_rain.shape[0]\nfor day in range(0, time_dim_len):\n    fpath_str = f\"./{day}.tif\"\n    acc_rain[day,:].rio.to_raster(fpath_str,\n                                  driver=\"COG\",\n                                  overview_count=10)","visibility":"show","key":"FTtWftOK3D"},{"type":"output","id":"zq7jf947YmJ0OXj1GR0dW","data":[],"visibility":"show","key":"KM3FZMpwZp"}],"visibility":"show","key":"A7TTHgKQOQ"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"import leafmap\nfrom localtileserver import get_leaflet_tile_layer\n\nm = leafmap.Map(center=roi_extent.get_center(),\n                zoom=6, height=600)\n\nlayer_dict = {}\ndate_vals = np.datetime_as_string(acc_rain[\"time\"].values, unit='D')\nfor day in range(0, time_dim_len):\n    layer_dict[date_vals[day]]= get_leaflet_tile_layer(f\"./{day}.tif\",\n                                                       colormap=\"Blues\",\n                                                       indexes=[1],\n                                                       nodata=0.,\n                                                       vmin=acc_rain.min().values,\n                                                       vmax=acc_rain.max().values,\n                                                       opacity=0.85)\n\nm.add_local_tile(flood_prep,\n                 colormap=\"Blues\",\n                 nodata=0.)\nm.add_time_slider(layer_dict,\n                  layer=\"Accumluated Rainfall\",\n                  time_interval=1.)\nm","visibility":"show","key":"n8QAUzlocj"},{"type":"output","id":"BK6f94PZAUr2edIUogJrk","data":[],"visibility":"show","key":"oLBYvV99MJ"}],"visibility":"show","key":"T8quBKP097"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"myDEDLClusters.shutdown()","visibility":"show","key":"NZR8WvRJ3x"},{"type":"output","id":"fN6YR8IEMiEJnH4N_UIld","data":[],"visibility":"show","key":"jjp5l6QUi4"}],"visibility":"show","key":"tYP4TAAftm"}],"key":"UYzjIpm46i"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"STACK Gallery","url":"/gallery-2","group":"STACK"},"next":{"title":"STACK service - Dask 101","url":"/stack-dask-101","group":"STACK"}}},"domain":"http://localhost:3001"},"project":{"title":"DEDL notebook gallery","id":"e0a20a08-c498-4ecc-8022-c5f820333f35","toc":[{"file":"README.md"},{"children":[{"file":"HDA/README.md"},{"children":[{"file":"HDA/PySTAC/HDA-PyStac-Client.ipynb"},{"file":"HDA/DestinE_Digital_Twins/ExtremeDT-dataAvailability.ipynb"},{"file":"HDA/DestinE_Digital_Twins/DEDL-HDA-EO.ECMWF.DAT.DT_EXTREMES.ipynb"},{"file":"HDA/DestinE_Digital_Twins/ClimateDT-ParameterPlotter.ipynb"},{"file":"HDA/DestinE_Digital_Twins/ExtremeDT-ParameterPlotter.ipynb"},{"file":"HDA/DestinE_Digital_Twins/DEDL-HDA-EO.ECMWF.DAT.DT_CLIMATE-Series.ipynb"},{"file":"HDA/DestinE_Digital_Twins/DEDL-HDA-EO.ECMWF.DAT.DT_EXTREMES-Series.ipynb"},{"file":"HDA/DestinE_Digital_Twins/DEDL-HDA-EO.ECMWF.DAT.DT_CLIMATE.ipynb"},{"file":"HDA/CDS_data/DEDL-HDA-EO.ECMWF.DAT.REANALYSIS_ERA5_SINGLE_LEVELS.ipynb"},{"file":"HDA/EODAG/HDA-EODAG-quick-start.ipynb"},{"file":"HDA/EODAG/HDA-EODAG-full-version.ipynb"},{"file":"HDA/EUM_data/DEDL-HDA-EO.EUM.DAT.METOP.AVHRRL1.ipynb"},{"file":"HDA/EUM_data/DEDL-HDA-EO.EUM.DAT.SENTINEL-3.OL_1_ERR___.ipynb"},{"file":"HDA/Fresh_Data_Pool/DEDL-HDA-EO.ESA.DAT.SENTINEL-1.L1_GRD.ipynb"},{"file":"HDA/Fresh_Data_Pool/DEDL-HDA-EO.ESA.DAT.SENTINEL-2.MSI.L2A.ipynb"},{"file":"HDA/REST/HDA-REST-full-version.ipynb"},{"file":"HDA/REST/HDA-REST-Queryables.ipynb"},{"file":"HDA/REST/HDA-REST-quick-start.ipynb"}],"file":"HDA/gallery.md"}],"title":"HDA"},{"children":[{"file":"HOOK/README.md"},{"children":[{"file":"HOOK/Tutorial.ipynb"},{"file":"HOOK/DEDL-Hook_access.ipynb"}],"file":"HOOK/gallery.md"}],"title":"HOOK"},{"children":[{"file":"STACK/README.md"},{"children":[{"file":"STACK/STACK-Python-Client-Dask.ipynb"},{"file":"STACK/STACK-Dask-101.ipynb"},{"file":"STACK/ExtremeDT-DataCube.ipynb"},{"file":"STACK/ExtremeDT-DataCube-xViewer.ipynb"},{"file":"STACK/DEDL_StackService_Dask.ipynb"}],"file":"STACK/gallery.md"}],"title":"STACK"},{"children":[{"url":"https://katharinastarzer21.github.io/myst_DEDL_page/production/MYFIRSTTEST/","title":"My first Test"}],"title":"Cookbook Gallery"}],"thumbnail":"/build/DestinE-banner-25c00cbd0eb44a5aaf58adf7cf4a10ad.jpg","exports":[],"bibliography":[],"index":"index","pages":[{"level":1,"title":"HDA"},{"slug":"readme","title":"DestinE Harmonised Data Access (HDA)","description":"","date":"","thumbnail":"/build/DestinE-banner-25c00cbd0eb44a5aaf58adf7cf4a10ad.jpg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"gallery","title":"HDA Gallery","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"hda-pystac-client","title":"HDA PySTAC-Client Introduction","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"extremedt-dataavailability","title":"Extreme DT Data Availability","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"dedl-hda-eo-ecmwf-dat-dt-extremes","title":"Destination Earth - Weather-Induced Extremes Digital Twin - Data Access using DEDL HDA","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"climatedt-parameterplotter","title":"DEDL - HDA Climate DT Parameter Plotter - Tutorial","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"extremedt-parameterplotter","title":"DEDL - HDA Extreme DT Parameter Plotter - Tutorial","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"dedl-hda-eo-ecmwf-dat-dt-climate-series","title":"Destination Earth - Climate Change Adaptation Digital Twin Series Plot- Data Access using DEDL HDA","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"dedl-hda-eo-ecmwf-dat-dt-extremes-series","title":"Destination Earth - Weather-Induced Extremes Digital Twin - Data Access using DEDL HDA","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"dedl-hda-eo-ecmwf-dat-dt-climate","title":"Destination Earth - Climate Change Adaptation Digital Twin - Data Access using DEDL HDA","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"dedl-hda-eo-ecmwf-dat-reanalysis-era5-single-level","title":"Destination Earth - ERA5 hourly data on single levels from 1940 to present - Data Access using DEDL HDA","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"hda-eodag-quick-start","title":"DEDL - EODAG - A quick start with DEDL","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"hda-eodag-full-version","title":"DEDL - EODAG - DestinE Data Lake Provider (DEDL)","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"dedl-hda-eo-eum-dat-metop-avhrrl1","title":"Destination Earth - AVHRR Level 1B Metop Global - Data Access using DEDL HDA","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"dedl-hda-eo-eum-dat-sentinel-3-ol-1-err","title":"Destination Earth - OLCI Level 1B Reduced Resolution - Sentinel-3 - Data Access using DEDL HDA","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"dedl-hda-eo-esa-dat-sentinel-1-l1-grd","title":"Example of Using HDA to Find and Download Data for Urban Area Monitoring Using Sentinel-1 Data","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"dedl-hda-eo-esa-dat-sentinel-2-msi-l2a","title":"Example of how to use HDA to find and download data for conducting monitoring of Śniadrwy lake","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"hda-rest-full-version","title":"DEDL - HDA Tutorial","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"hda-rest-queryables","title":"DEDL - HDA Tutorial - Queryables","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"hda-rest-quick-start","title":"DEDL - HDA Tutorial - quick start","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"HOOK"},{"slug":"readme-1","title":"Hook Service","description":"","date":"","thumbnail":"/build/EUMETSAT-icon-35c5bf6f00a42bb69e5b27bc3eba1f7d.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"gallery-1","title":"HOOK Gallery","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"tutorial","title":"DEDL - Hook Tutorial - Data Harvest (data-harvest)","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"dedl-hook-access","title":"Access to Hook services","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"STACK"},{"slug":"readme-2","title":"STACK Service","description":"","date":"","thumbnail":"/build/DestinE-banner-25c00cbd0eb44a5aaf58adf7cf4a10ad.jpg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"gallery-2","title":"STACK Gallery","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"stack-python-client-dask","title":"STACK service - Python Client Dask","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"stack-dask-101","title":"STACK service - Dask 101","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"extremedt-datacube","title":"Data Cube populated with data obtained from Weather and Geophysical Extremes Digital Twin (DT) - ExtremeDT","description":"","date":"","thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"extremedt-datacube-xviewer","title":"Create a dashboard based on Data Cube populated with data obtained from Weather and Geophysical Extremes Digital Twin (DT) - ExtremeDT","description":"","date":"","thumbnail":"/build/13671a697054e05ccbcc105d371ab38b.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"dedl-stackservice-dask","title":"DestinE Data Lake - Stack Service Dask","description":"","date":"","thumbnail":"/build/9aaf3e76d727ec891c8c02168fe0567d.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"Cookbook Gallery"}]}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":true,"v2_headers":true,"v2_meta":true,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/build/manifest-2671EB98.js";
import * as route0 from "/build/root-LMCDRB6W.js";
import * as route1 from "/build/routes/$-SJYMRUNJ.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/build/entry.client-UNPC4GT3.js");</script></body></html>